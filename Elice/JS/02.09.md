# 2/9 비동기 통신과 Promise

## 자바스크립트 제어 흐름

- 자바스크립트는 다른 멀티 스레드 프로그래밍 언어와 다른 방식으로 비동기 동작 처리.
- 자바스크립트 엔진: 하나의 메인 스레드로 구성.

- `동기적 제어 흐름`: 현재 실행 중인 코드 종료 전까지 다음 줄의 코드 실행하지 않는 것. 분기문, 반복문, 함수 호출 등이 동기적으로 실행됨.
- 싱글 스레드 환경에서 메인 스레드를 긴 시간 점유하면 프로그램을 멈추게 함.

- `비동기적 제어 흐름`: 현재 실행중인 코드의 종료 전에 다음 라인의 코드 실행하는 것. 프로미스, 콜백 함수를 호출하는 함수 등은 비동기적으로 실행.
- 비동기 작업을 기다리는 동안 메인 스레드는 다른 작업 처리.

## 이벤트 루프

- JS 엔진은 비동기 처리를 제공하지 않음. 대신 비동기 API(setTimeout, XMLHttpRequest, fetch 등의 Web API, node.js는 파일 처리 API, 암호화 API)를 활용 가능.
- 이벤트 루프는 JS 엔진 외부에 존재.(node.js는 libuv라는 모듈에서 비동기 처리.)
- 이벤트 루프는 콜 스택이 비워지는 것을 기다렸다가 태스크 큐에서 콜백 함수 꺼냄.
- 비동기 처리 끝나면 태스크 큐에 콜백 함수 들어감.

## Promise

- Promise API는 비동기 API 중 하나. 태스크 큐가 아닌 잡 큐 사용. (잡큐는 태스크큐보다 우선순위 높음).
- 비동기 작업의 진행, 성공, 실패 상태 표현. 비동기 처리의 순서 표현 가능.
- 메서드 체인: then/catch 메서드가 또 다른 프로미스를 리턴해 비동기 코드에 순서 부여.
- Promise 객체는 비동기 처리 중에 pending 상태를 표현할 수 있고, Promise.prototype.finally() 메서드는 Promise가 settled 되었을 시 항상 호출됨.
